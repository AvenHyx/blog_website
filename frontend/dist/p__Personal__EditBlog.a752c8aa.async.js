(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[132],{16725:function(B){B.exports={"edit-wrapper":"edit-wrapper___3ehdV",editHeader:"editHeader___3GPXe",topBar:"topBar___kBg0h",title:"title___1hGZa",rightContent:"rightContent___1-8RB",editContent:"editContent___r5idJ",edit:"edit___3rvfP",preview:"preview___2Hdwi",previewTitle:"previewTitle___P9jjh",htmlStyle:"htmlStyle___2jOPB"}},55961:function(B,P,e){"use strict";var Z=e(71194),p=e(48889),N=e(67294),O=e(85893);P.Z=function(v){var U=v.destroyOnClose,y=v.modalTitle,C=v.children,I=v.handleOk,K=v.handleCancel,D=v.isModalVisible;return(0,O.jsx)(O.Fragment,{children:(0,O.jsx)(p.Z,{destroyOnClose:U,Modal:!0,title:y,visible:D,onOk:I,onCancel:K,children:C&&C})})}},38776:function(B,P,e){"use strict";e.r(P),e.d(P,{default:function(){return te}});var Z=e(57663),p=e(71577),N=e(47673),O=e(1011),v=e(9715),U=e(41003),y=e(43185),C=e(98670),I=e(11849),K=e(34792),D=e(48086),le=e(71194),T=e(48889),b=e(3182),H=e(69610),V=e(54941),F=e(81306),G=e(19809),se=e(43358),W=e(39167),$=e(94043),g=e.n($),j=e(67294),z=e(85589),A=e.n(z),J=e(32452),Q=e(42017),_e=e.n(Q),X=e(43581),Y=e(47448),w=e(16725),h=e.n(w),L=e(41493),k=e(9669),re=e.n(k),q=e(55961),S=e(37406),l=e(85893),ee=W.Z.Option,te=function(ae){(0,F.Z)(f,ae);var ne=(0,G.Z)(f);function f(R){var M,t;return(0,H.Z)(this,f),t=ne.call(this,R),t.mapBlogById=(0,b.Z)(g().mark(function _(){return g().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,L.mapBlogById({blogId:t.state.blogId}).then(function(s){var r=s.blogId,c=s.blogContent,a=s.blogTitle,n=s.tagId;t.setState({tagId:[n],previewTagId:[n],blogTitle:a,editorState:A().createEditorState(c)})});case 2:case"end":return u.stop()}},_)})),t.handleChange=function(_){t.setState({editorState:_})},t.uploadHandler=function(){var _=(0,b.Z)(g().mark(function d(u){return g().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:t.setState({editorState:J.ContentUtils.insertMedias(t.state.editorState,[{type:"IMAGE",url:u}])});case 1:case"end":return r.stop()}},d)}));return function(d){return _.apply(this,arguments)}}(),t.releaseArticle=(0,b.Z)(g().mark(function _(){var d,u,s,r;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(d=t.state,u=d.editorState,s=d.blogTitle,r={title:"\u535A\u6587\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A",content:"\u535A\u6587\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A",less:"\u535A\u6587\u6807\u9898\u5B57\u6570\u57285-100\u4EE5\u5185"},s){a.next=6;break}return a.abrupt("return",T.Z.error({content:r.title}));case 6:if(!(s.length<5||s.length>100)){a.next=10;break}return a.abrupt("return",T.Z.error({content:r.less}));case 10:if(u.toHTML().length!=7){a.next=12;break}return a.abrupt("return",T.Z.error({content:r.content}));case 12:return a.prev=12,a.next=15,L.getTags({}).then(function(n){if((n!=null?n:"")!==""){var m=t.state.tagId;if(m.length){var o,E=((o=n.filter(function(x){return x.tagId===m[0]})[0])===null||o===void 0?void 0:o.tagName)||[];t.setState({tagName:E})}t.setState({tagList:n})}});case 15:a.next=19;break;case 17:a.prev=17,a.t0=a.catch(12);case 19:t.setState({isModalVisible:!0});case 20:case"end":return a.stop()}},_,null,[[12,17]])})),t.handleBlogModal=function(){var _=(0,b.Z)(g().mark(function d(u){var s,r,c,a,n,m,o,E;return g().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(s=t.state,r=s.tagId,c=s.blogTitle,a=s.editorState,n=s.blogId,m=s.previewTagId,u!=!0){i.next=18;break}if(r.length){i.next=4;break}return i.abrupt("return",D.default.error("\u8BF7\u9009\u62E9\u6587\u7AE0\u6807\u7B7E",2));case 4:return o={blogTitle:c,blogContent:a.toHTML(),tagId:Array.isArray(r)?r[0]:r},o=n?(0,I.Z)((0,I.Z)({},o),{},{blogId:n}):o,i.prev=6,i.next=9,L["".concat(n!==""?"modifyBlog":"sendBlog")](o);case 9:E=i.sent,E?t.setState({isModalVisible:!1},function(){T.Z.success({content:"".concat(n?"\u7F16\u8F91":"\u53D1\u5E03","\u6210\u529F"),onOk:function(){X.m8.push("/center")}})}):D.default.error("".concat(n?"\u7F16\u8F91":"\u53D1\u5E03","\u5931\u8D25")),i.next=16;break;case 13:i.prev=13,i.t0=i.catch(6),D.default.error("".concat(n?"\u7F16\u8F91":"\u53D1\u5E03","\u5931\u8D25"));case 16:i.next=19;break;case 18:t.setState({isModalVisible:!1,tagId:m});case 19:case"end":return i.stop()}},d,null,[[6,13]])}));return function(d){return _.apply(this,arguments)}}(),t.handleChangeTagSelect=function(_){t.setState({tagId:_.length?_[0]:[]})},t.changeBlogTitle=function(_){t.setState({blogTitle:_.target.value})},t.state={editorState:A().createEditorState("<p></p>"),isModalVisible:!1,tagList:[],tagId:[],blogTitle:"",blogId:((M=(0,S.pf)("id"))!==null&&M!==void 0?M:!1)?(0,S.pf)("id"):""},t.editorRef=j.createRef(),t}return(0,V.Z)(f,[{key:"componentDidMount",value:function(){this.state.blogId&&this.mapBlogById()}},{key:"render",value:function(){var M=this,t=this.state,_=t.isModalVisible,d=t.tagList,u=t.tagId,s=t.blogTitle,r=t.tagName,c=["letter-spacing","line-height","clear","headings","remove-styles","superscript","subscript","hr","text-align"],a=[{key:"antd-uploader",type:"component",component:(0,l.jsx)(C.Z,{accept:"image/*",showUploadList:!1,action:"/api/upload/avatar",onChange:function(m){var o,E=m.file;(E==null?void 0:E.status)=="done"&&(E==null||(o=E.response)===null||o===void 0?void 0:o.businessCode)==1e3&&M.uploadHandler(E.response.content)},children:(0,l.jsx)("button",{type:"button",className:"control-item button upload-button","data-title":"\u63D2\u5165\u56FE\u7247",children:(0,l.jsx)(Y.Z,{})})})}];return(0,l.jsxs)("div",{className:"editor-wrapper",children:[_&&(0,l.jsx)(q.Z,{isModalVisible:_,handleOk:function(){return M.handleBlogModal(!0)},handleCancel:function(){return M.handleBlogModal(!1)},modalTitle:"\u53D1\u5E03\u535A\u6587",destroyOnClose:!0,children:(0,l.jsx)(U.Z.Item,{label:"\u6587\u7AE0\u6807\u7B7E",name:"\u6587\u7AE0\u6807\u7B7E",initialvalues:"",children:(0,l.jsx)(W.Z,{mode:"multiple",size:"large",placeholder:"\u8BF7\u9009\u62E9\u6807\u7B7E",defaultValue:[r],onChange:this.handleChangeTagSelect,style:{width:"100%"},maxTagCount:5,showArrow:!0,children:d.length&&d.map(function(n,m){return(0,l.jsx)(ee,{children:n.tagName},n.tagId)})})})}),(0,l.jsxs)("header",{className:h().editHeader,children:[(0,l.jsx)("div",{className:h().topBar,children:(0,l.jsx)(O.Z,{className:h().title,value:s,placeholder:"\u8BF7\u8F93\u5165\u6587\u7AE0\u6807\u9898",onChange:this.changeBlogTitle})}),(0,l.jsx)("div",{className:h().rightContent,children:(0,l.jsx)(p.Z,{type:"primary",style:{width:100,marginRight:20},onClick:this.releaseArticle,children:"\u53D1\u5E03"})})]}),(0,l.jsx)("main",{children:(0,l.jsxs)("div",{className:h().editContent,children:[(0,l.jsx)("div",{className:h().edit,children:(0,l.jsx)(A(),{ref:this.editorRef,value:this.state.editorState,onChange:this.handleChange,extendControls:a,excludeControls:c})}),(0,l.jsxs)("div",{className:h().preview,children:[(0,l.jsx)("div",{className:h().previewTitle,children:"\u754C\u9762\u9884\u89C8"}),(0,l.jsx)("div",{id:"content",className:h().htmlStyle,dangerouslySetInnerHTML:{__html:this.state.editorState.toHTML()}})]})]})})]})}}]),f}(j.Component)}}]);
